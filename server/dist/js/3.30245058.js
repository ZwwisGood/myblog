"use strict";(self["webpackChunkmyblog"]=self["webpackChunkmyblog"]||[]).push([[3],{1003:function(t,e,i){i.r(e),i.d(e,{default:function(){return h}});var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"edit animate__animated animate__fadeIn"},[i("div",[i("span",[t._v("标题：")]),i("el-input",{staticClass:"title",attrs:{placeholder:"请输入文章标题（必填）"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),t._v("    "),i("span",[t._v("文章类型：")]),i("el-input",{staticClass:"title",attrs:{placeholder:"请输入文章类型（必填）"},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}})],1),i("div",[i("span",[t._v("描述：")]),i("el-input",{staticClass:"description",attrs:{placeholder:"请输入文章描述（选填）"},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}})],1),i("mavon-editor",{ref:"md",staticClass:"markdown",attrs:{toolbars:t.toolbars},on:{imgAdd:t.imgAdd,save:t.save},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),i("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:t.save}},[t._v("保存修改")]),i("el-button",{staticClass:"btn",attrs:{type:"danger"},on:{click:t.back}},[t._v("返回")])],1)},a=[],n=i(2747),o=i.n(n),l={data(){return{type:"",htmlcontent:"",title:"",description:"",content:"",toolbars:{bold:!0,header:!0,underline:!0,quote:!0,link:!0,imagelink:!0,code:!0,subfield:!0,readmodel:!0,undo:!0,trash:!0,navigation:!0}}},methods:{handleHtmlContent(){let t=0,e=this.htmlcontent,i=e;while(/\+\+/.test(i))0==t?(i=i.replace(/\+\+/,"<u>"),t++):1==(1&t)?(i=i.replace(/\+\+/,"</u>"),t++):0==(1&t)&&(i=i.replace(/\+\+/,"<u>"),t++);this.htmlcontent=i},save(){""!=this.title?""!=this.type?""!=this.content?o().confirm("确定保存修改吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((()=>{this.confirmSave()})).catch((()=>{})):this.$msg.error("内容不能为空"):this.$msg.error("类型不能为空"):this.$msg.error("标题不能为空")},async confirmSave(){const t=this.$route.query.id;this.htmlcontent=this.converter.makeHtml(this.content);try{let e=await this.$api({url:"/api/updateBlog",method:"post",data:{id:t,type:this.type,title:this.title,description:this.description,content:this.content,htmlcontent:this.htmlcontent}});0==e.code?this.$msg({message:"修改成功",type:"success"}):this.$msg.error({message:"修改失败"})}catch(e){console.log(e),this.$msg.error("修改失败")}},back(){this.$router.go(-1)},async imgAdd(t,e){try{let i=new FormData;i.append("file",e);let s=await this.$api({url:"/api/upload",method:"post",data:i,headers:{"Content-Type":"multipart/form-data"}});this.$refs.md.$img2Url(t,s.url)}catch(i){console.log(i)}}},async created(){const t=this.$route.query.id;try{let e=await this.$api({url:"/api/getBlogById",method:"get",params:{id:t}});0==e.code?(this.type=e.data[0].type,this.title=e.data[0].title,this.description=e.data[0].description,this.content=e.data[0].content,this.htmlcontent=e.data[0].htmlcontent,this.handleHtmlContent()):this.$msg.error(e.msg)}catch(e){console.log(e),this.$msg.error("出现了错误")}}},r=l,c=i(1001),d=(0,c.Z)(r,s,a,!1,null,"4d7d92c2",null),h=d.exports}}]);