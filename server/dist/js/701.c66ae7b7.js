"use strict";(self["webpackChunkmyblog"]=self["webpackChunkmyblog"]||[]).push([[701],{3701:function(t,e,i){i.r(e),i.d(e,{default:function(){return p}});var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"add animate__animated animate__fadeIn"},[i("div",[i("span",[t._v("标题：")]),i("el-input",{staticClass:"title",attrs:{placeholder:"请输入文章标题（必填）"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),t._v("    "),i("span",[t._v("文章类型：")]),i("el-input",{staticClass:"title",attrs:{placeholder:"请输入文章类型（必填）"},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}})],1),i("div",[i("span",[t._v("描述：")]),i("el-input",{staticClass:"description",attrs:{placeholder:"请输入文章描述（选填）"},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}})],1),i("mavon-editor",{ref:"md",staticClass:"markdown",attrs:{toolbars:t.toolbars},on:{imgAdd:t.imgAdd,save:t.save},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),i("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:t.addBlog}},[t._v("发表")]),i("el-button",{staticClass:"btn",attrs:{type:"info"},on:{click:t.save}},[t._v("暂存")]),i("el-button",{staticClass:"btn",attrs:{type:"danger"},on:{click:t.clear}},[t._v("清空并删除已暂存内容")])],1)},o=[],a=i(2747),n=i.n(a),l={data(){return{type:"",htmlcontent:"",title:"",description:"",content:"",toolbars:{bold:!0,header:!0,underline:!0,quote:!0,link:!0,imagelink:!0,code:!0,subfield:!0,readmodel:!0,undo:!0,trash:!0,navigation:!0}}},methods:{async addBlog(){if(""==this.title)return void this.$msg.error("标题不能为空");if(""==this.type)return void this.$msg.error("类型不能为空");if(""==this.content)return void this.$msg.error("内容不能为空");this.htmlcontent=this.converter.makeHtml(this.content);let t=Math.floor(3*Math.random())+1;try{await this.$api({url:"/api/addblog",method:"post",data:{type:this.type,title:this.title,description:this.description,content:this.content,htmlcontent:this.htmlcontent,img:`/images/card${t}.jpg`}});this.$msg({message:"添加成功",type:"success"}),localStorage.removeItem("blog")}catch(e){console.log(e),this.$msg.error("添加失败")}},async imgAdd(t,e){console.log("imgAdd"),console.log(e);var i=new FormData;i.append("file",e),console.log(i.get("file"));try{let i=new FormData;i.append("file",e);let s=await this.$api({url:"/api/upload",method:"post",data:i,headers:{"Content-Type":"multipart/form-data"}});this.$refs.md.$img2Url(t,s.url)}catch(s){console.log(s)}},save(){if(""==this.title)return void this.$msg.error("标题不能为空");if(""==this.type)return void this.$msg.error("类型不能为空");if(""==this.content)return void this.$msg.error("内容不能为空");let t={title:this.title,type:this.type,description:this.description,content:this.content};localStorage.setItem("blog",JSON.stringify(t)),this.$msg({message:"暂存成功",type:"success"})},clear(){n().confirm("确定清空所有内容吗? 你已暂存的内容也会被清除","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((()=>{this.title="",this.type="",this.description="",this.content="",localStorage.removeItem("blog"),this.$msg({message:"已清空",type:"success"})})).catch((()=>{}))}},created(){localStorage.getItem("blog")&&(this.title=JSON.parse(localStorage.getItem("blog")).title,this.type=JSON.parse(localStorage.getItem("blog")).type,this.description=JSON.parse(localStorage.getItem("blog")).description,this.content=JSON.parse(localStorage.getItem("blog")).content)}},r=l,c=i(1001),d=(0,c.Z)(r,s,o,!1,null,"6ff589c4",null),p=d.exports}}]);